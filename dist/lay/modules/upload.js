/** layui-v2.2.5 MIT License By https://www.layui.com */
 ;layui.define("layer",function(e){"use strict";var t,i=layui.$,n=layui.layer,o=layui.hint(),a=layui.device(),l={config:{},set:function(e){var t=this;return t.config=i.extend({},t.config,e),t},on:function(e,t){return layui.onevent.call(this,u,e,t)}},r=function(){var e=this;return{upload:function(t){e.upload.call(e,t)},config:e.config}},u="upload",c="layui-upload-file",f="layui-upload-form",s="layui-upload-iframe",p="layui-upload-choose",d=function(e){var t=this;t.config=i.extend({},t.config,l.config,e),t.render()};d.prototype.config={accept:"images",exts:"",auto:!0,bindAction:"",url:"",field:"file",method:"post",data:{},drag:!0,size:0,number:0,multiple:!1},d.prototype.render=function(e){var t=this,e=t.config;e.elem=i(e.elem),e.bindAction=i(e.bindAction),t.file(),t.events()},d.prototype.file=function(){var e=this,t=e.config,n=e.elemFile=i(['<input class="'+c+'" type="file" name="'+t.field+'"',t.multiple?" multiple":"",">"].join("")),o=t.elem.next();(o.hasClass(c)||o.hasClass(f))&&o.remove(),a.ie&&a.ie<10&&t.elem.wrap('<div class="layui-upload-wrap"></div>'),e.isFile()?(e.elemFile=t.elem,t.field=t.elem[0].name):t.elem.after(n),a.ie&&a.ie<10&&e.initIE()},d.prototype.initIE=function(){var e=this,t=e.config,n=i('<iframe id="'+s+'" class="'+s+'" name="'+s+'" frameborder="0"></iframe>'),o=i(['<form target="'+s+'" class="'+f+'" method="'+t.method,'" key="set-mine" enctype="multipart/form-data" action="'+t.url+'">',"</form>"].join(""));i("#"+s)[0]||i("body").append(n),t.elem.next().hasClass(s)||(e.elemFile.wrap(o),t.elem.next("."+s).append(function(){var e=[];return layui.each(t.data,function(t,i){e.push('<input type="hidden" name="'+t+'" value="'+i+'">')}),e.join("")}()))},d.prototype.msg=function(e){return n.msg(e,{icon:2,shift:6})},d.prototype.isFile=function(){var e=this.config.elem[0];if(e)return"input"===e.tagName.toLocaleLowerCase()&&"file"===e.type},d.prototype.preview=function(e){var t=this;window.FileReader&&layui.each(t.chooseFiles,function(t,i){var n=new FileReader;n.readAsDataURL(i),n.onload=function(){e&&e(t,i,this.result)}})},d.prototype.upload=function(e,n){var o,l=this,r=l.config,u=l.elemFile[0],c=function(){var n=0,o=0,a=e||l.files||l.chooseFiles||u.files,c=function(){r.multiple&&n+o===l.fileLength&&"function"==typeof r.allDone&&r.allDone({total:l.fileLength,successful:n,aborted:o})};layui.each(a,function(e,a){var u=new FormData;u.append(r.field,a),layui.each(r.data,function(e,t){u.append(e,t)});var f={url:r.url,type:r.method,data:u,contentType:!1,processData:!1,dataType:"json",timeout:r.timeout||null,success:function(t){n++,m(e,t),c()},error:function(){o++,l.msg("请求上传接口出现异常"),v(e),c()}};"function"==typeof r.onprogress&&(f.xhr=function(){var e=i.ajaxSettings.xhr();if(e.upload)return e.upload.addEventListener("progress",r.onprogress,!1),e}),i.ajax(f),r.keepAlive&&(t=setInterval(function(){i.get(r.keepAlive)},6e5))})},f=function(){var e=i("#"+s);l.elemFile.parent().submit(),clearInterval(d.timer),d.timer=setInterval(function(){var t,i=e.contents().find("body");try{t=i.text()}catch(n){l.msg("获取上传后的响应信息出现异常"),clearInterval(d.timer),v()}t&&(clearInterval(d.timer),i.html(""),m(0,t))},30)},m=function(e,i){if(l.elemFile.next("."+p).remove(),u.value="","object"!=typeof i)try{i=JSON.parse(i)}catch(n){return i={},l.msg("请对上传接口返回有效JSON")}"function"==typeof r.done&&r.done(i,e||0,function(e){l.upload(e)}),t&&clearInterval(t)},v=function(e){r.auto&&(u.value=""),"function"==typeof r.error&&r.error(e||0,function(e){l.upload(e)})},h=r.exts,g=function(){var t=[];return layui.each(e||l.chooseFiles,function(e,i){t.push(i.name)}),t}(),y={preview:function(e){l.preview(e)},upload:function(e,t){var i={};i[e]=t,l.upload(i)},pushFile:function(){return l.files=l.files||{},layui.each(l.chooseFiles,function(e,t){l.files[e]=t}),l.files}},F=function(){return"choose"===n?r.choose&&r.choose(y):(r.before&&r.before(y),a.ie?a.ie>9?c():f():void c())};if(g=0===g.length?u.value.match(/[^\/\\]+\..+/g)||[]||"":g,0!==g.length){switch(r.accept){case"file":if(h&&!RegExp("\\w\\.("+h+")$","i").test(escape(g)))return l.msg("选择的文件中包含不支持的格式"),u.value="";break;case"video":if(!RegExp("\\w\\.("+(h||"avi|mp4|wma|rmvb|rm|flash|3gp|flv")+")$","i").test(escape(g)))return l.msg("选择的视频中包含不支持的格式"),u.value="";break;case"audio":if(!RegExp("\\w\\.("+(h||"mp3|wav|mid")+")$","i").test(escape(g)))return l.msg("选择的音频中包含不支持的格式"),u.value="";break;default:if(layui.each(g,function(e,t){RegExp("\\w\\.("+(h||"jpg|png|gif|bmp|jpeg$")+")","i").test(escape(t))||(o=!0)}),o)return l.msg("选择的图片中包含不支持的格式"),u.value=""}if(l.fileLength=function(){var t=0,i=e||l.files||l.chooseFiles||u.files;return layui.each(i,function(){t++}),t}(),r.number&&l.fileLength>r.number)return l.msg("同时最多只能上传的数量为："+r.number);if(r.size>0&&!(a.ie&&a.ie<10)){var b;if(layui.each(l.chooseFiles,function(e,t){if(t.size>1024*r.size){var i=r.size/1024;i=i>=1?Math.floor(i)+(i%1>0?i.toFixed(1):0)+"MB":r.size+"KB",u.value="",b=i}}),b)return l.msg("文件不能超过"+b)}F()}},d.prototype.events=function(){var e=this,t=e.config,n=function(t){e.chooseFiles={},layui.each(t,function(t,i){var n=(new Date).getTime();e.chooseFiles[n+"-"+t]=i})},l=function(i,n){var o=e.elemFile,a=i.length>1?i.length+"个文件":(i[0]||{}).name||o[0].value.match(/[^\/\\]+\..+/g)||[]||"";o.next().hasClass(p)&&o.next().remove(),e.upload(null,"choose"),e.isFile()||t.choose||o.after('<span class="layui-inline '+p+'">'+a+"</span>")};t.elem.off("upload.start").on("upload.start",function(){var n=i(this),a=n.attr("lay-data");if(a)try{a=new Function("return "+a)(),e.config=i.extend({},t,a)}catch(l){o.error("Upload element property lay-data configuration item has a syntax error: "+a)}e.config.item=n,e.elemFile[0].click()}),a.ie&&a.ie<10||t.elem.off("upload.over").on("upload.over",function(){var e=i(this);e.attr("lay-over","")}).off("upload.leave").on("upload.leave",function(){var e=i(this);e.removeAttr("lay-over")}).off("upload.drop").on("upload.drop",function(o,a){var r=i(this),u=a.originalEvent.dataTransfer.files||[];r.removeAttr("lay-over"),n(u),t.auto?e.upload(u):l(u)}),e.elemFile.off("upload.change").on("upload.change",function(){var i=this.files||[];n(i),t.auto?e.upload():l(i)}),t.bindAction.off("upload.action").on("upload.action",function(){e.upload()}),t.elem.data("haveEvents")||(e.elemFile.on("change",function(){i(this).trigger("upload.change")}),t.elem.on("click",function(){e.isFile()||i(this).trigger("upload.start")}),t.drag&&t.elem.on("dragover",function(e){e.preventDefault(),i(this).trigger("upload.over")}).on("dragleave",function(e){i(this).trigger("upload.leave")}).on("drop",function(e){e.preventDefault(),i(this).trigger("upload.drop",e)}),t.bindAction.on("click",function(){i(this).trigger("upload.action")}),t.elem.data("haveEvents",!0))},l.render=function(e){var t=new d(e);return r.call(t)},e(u,l)});